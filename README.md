# Система автоматизации некоторых вопросов магистратуры

Данна система предназначена для упрощения жизни студентам магистрантам матмеха.

Версия: 1.0

## Что должно быть на машине разработчика

- Java 17
- `node.js` версии 16.20.2 (если нужно иметь возможность использовать несколько 
версий `node.js` на одной машине, то рекомендую использовать `nvm`)
- `yarn` версии 1.22.19
- Любимые IDE. Рекомендую IntelliJ IDEA для бэкенда и Webstorm для фронта. Если 
нет лицензии, то Visual Studio Code.

## Как поднять приложение локально для разработки?

1. Запустить сервер PostreSQL
   - Зайти в папку `[директория установки постгреса]/bin/`
   - В командной строке ввести `postres.exe -D [папка, выбранная для хранения 
   данных (data)]`
2. Создать в `*path-to-projct*/src/main/resources` файл `application.properties`.
Какие надо указать свойства:
    - `jwt.secret` - секрет для JWT
    - `jwt.lifetime` - срок жизни JWT
    - `spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect` - если используешь Postgres
   - `spring.datasource.url` - где находится база данных
   - `spring.datasource.username` - логин для базы данных
   - `spring.datasource.password` - пароль для базы данных
   - `spring.jpa.show-sql=true` - если хочешь смотреть на генерируемый HQL
   - `spring.jpa.generate-ddl=true` - генерировать ли код для инициализации 
базы данных
   - `spring.jpa.hibernate.ddl-auto` - режим работы с базой данных при запуске
приложения
   - `spring.jpa.defer-datasource-initialization=true` - инициализация 
Hibernate (?)
   - `spring.sql.init.mode=always` - инициализация схемы (?)
   - `spring.main.allow-circular-references=true` - разрешение циклических
зависимостей. Пока так, проблема в системе авторизации пользователя.
   - `server.port=5000` - порт сервера
3. Сбилдить и запустить проект через `gradle bootRun` 
4. Запустить фронт `yarn start` на порту 3001. Все запросы будут идти через него, 
статику он будет отдавать напрямую, а API запросы редиректить на бэкенд. При 
изменениях на фронте, он автоматически всё пересоберёт и обновит фронт, ничего 
перезапускать не нужно. Ошибки компиляции также будут там отображаться. Ещё 
стоит обращать внимание на ворнинги в консоли браузера при разработке.
5. Зайти в браузер: http://localhost:3001

Чтобы проинициализировать базу данных можно запустить тест 
`CoreApplicationTests.init()`. Если надо удалить бд, а потом 
проинициализировать ее, то можно использовать тест 
`CoreApplicationTests.recreate()`. Есть еще `CoreApplicationTests.drop()`.

# Docker

Не забудь поменять пути в `application.properties` и в `package.json`.

# Disclaimer

На данный момент эта версия тупо переписана с C# на Java. Местами там 
встречается плохой код. 

Работает все, кроме системы рекомендаций. Я просто не смог сходу разобраться и 
понять то ли система не работает, то ли я что-то перенес с ошибками.

Думаю, что за счет знакомых технологий дело пойдет быстрее и проще для всех
участников процесса.
